DROP TABLE OEP_RESULTS;
DROP TABLE OEP_QUESTIONS;
DROP TABLE OEP_COURSE;
DROP TABLE OEP_USERS;



CREATE TABLE OEP_USERS ( 
USER_ID NUMBER(10),
USER_FNAME VARCHAR2(20),
USERNAME VARCHAR2(40) ,
USER_PASSWORD VARCHAR2(65),
USER_EMAIL VARCHAR2(40) NOT NULL ,
USER_MOBILE_NO NUMBER(10) NOT NULL ,
USER_ROLE VARCHAR2(10) DEFAULT 'NUSER',
USER_STATUS VARCHAR2(10) DEFAULT 'INACTIVE',
CONSTRAINT CHK_TYPE CHECK (USER_ROLE IN ('NUSER','ADMIN')),
CONSTRAINT CHK_STATUS CHECK (USER_STATUS IN ('ACTIVE','INACTIVE')),
CONSTRAINT UNAME_UN UNIQUE (USERNAME),
CONSTRAINT UMOBILE_UN UNIQUE (USER_MOBILE_NO),
CONSTRAINT UEMAIL_UN UNIQUE (USER_EMAIL),
CONSTRAINT PK_USER_ID PRIMARY KEY (USER_ID) );



CREATE TABLE OEP_COURSE(
COURSE_ID NUMBER(10),
COURSE_NAME VARCHAR2(20),
COURSE_DESCRIPTION VARCHAR2(50),
COURSE_NO_QUESTIONS NUMBER(3),
COURSE_PASSING_SCORE NUMBER(3) NOT NULL,
CONSTRAINT CHK_SCORE CHECK(COURSE_PASSING_SCORE BETWEEN 0 AND 101),
CONSTRAINT PK_COURSE_ID PRIMARY KEY (COURSE_ID) );



CREATE TABLE OEP_QUESTIONS(
QUESTION_ID NUMBER(10),
COURSE_ID NUMBER(10),
QUESTION_DESCRIPTION VARCHAR2(40),
QUESTION_ANSWER VARCHAR2(40),
QUESTION_OPTIONS VARCHAR2(200),
CONSTRAINT PK_QUESTION_ID PRIMARY KEY (QUESTION_ID),
CONSTRAINT FK_COURSE_ID FOREIGN KEY (COURSE_ID) REFERENCES OEP_COURSE(COURSE_ID)
);




CREATE TABLE OEP_RESULTS(
RESULT_ID NUMBER(10),
COURSE_ID NUMBER(10),
USER_ID NUMBER(10),
RESULT_SCORE NUMBER(10),
RESULT_STATUS VARCHAR2(10),
RESULT_DATE DATE,
CONSTRAINT PK_RESULT_ID PRIMARY KEY (RESULT_ID,USER_ID,COURSE_ID),
CONSTRAINT CHK_STATUS_R CHECK (RESULT_STATUS IN ('PASS','FAIL')),
CONSTRAINT FK_USER_ID_R FOREIGN KEY (USER_ID) REFERENCES OEP_USERS(USER_ID),
CONSTRAINT FK_COURSE_ID_R FOREIGN KEY (COURSE_ID) REFERENCES OEP_COURSE(COURSE_ID));